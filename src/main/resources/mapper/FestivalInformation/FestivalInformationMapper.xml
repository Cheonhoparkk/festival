<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="today.whatdo.festival.mapper.FestivalInformationMapper">
	<sql id="festivalInformationColumns">
		ADDR1, ADDR2, AREACODE, BOOKTOUR, CAT1,
		CAT2, CAT3, CONTENTID, CONTENTTYPEID, CREATEDTIME,
		EVENTSTARTDATE, EVENTENDDATE, FIRSTIMAGE, FIRSTIMAGE2, MAPX,
		MAPY, MLEVEL, MODIFIEDTIME, READCOUNT, SIGUNGUCODE,
		TEL, TITLE
	</sql>
	<insert id="insertFestivalInformations">
		INSERT INTO FESTIVAL_INFORMATION(
		<include refid="festivalInformationColumns"></include>
		)
		VALUES
		<foreach collection="FestivalInfoList" item="FesInfo" separator=",">
				(
					#{FesInfo.addr1},#{FesInfo.addr2},#{FesInfo.areacode},#{FesInfo.booktour},#{FesInfo.cat1},
					#{FesInfo.cat2},#{FesInfo.cat3},#{FesInfo.contentid},#{FesInfo.contenttypeid},#{FesInfo.createdtime},
					#{FesInfo.eventstartdate},#{FesInfo.eventenddate},#{FesInfo.firstimage},#{FesInfo.firstimage2},#{FesInfo.mapx},
					#{FesInfo.mapy},#{FesInfo.mlevel},#{FesInfo.modifiedtime},#{FesInfo.readcount},#{FesInfo.sigungucode},
					#{FesInfo.tel},#{FesInfo.title}
				)
			</foreach>
	</insert>
	<insert id="insertFestivalInformation">
		INSERT INTO FESTIVAL_INFORMATION(
		<include refid="festivalInformationColumns"></include>
		)
		VALUES
		(
			#{addr1},#{addr2},#{areacode},#{booktour},#{cat1},
			#{cat2},#{cat3},#{contentid},#{contenttypeid},#{createdtime},
			#{eventstartdate},#{eventenddate},#{firstimage},#{firstimage2},#{mapx},
			#{mapy},#{mlevel},#{modifiedtime},#{readcount},#{sigungucode},
			#{tel},#{title}
		)
	</insert>
	<select id="selectFestivalInformation" resultType="today.whatdo.festival.vo.festivalInfo.FestivalInformationVO">
		SELECT FI_NUM,
		<include refid="festivalInformationColumns"></include>
		FROM FESTIVAL_INFORMATION
		WHERE CONTENTID = #{contentid}
	</select>
	<select id="selectFestivalInformationByNum" resultType="today.whatdo.festival.vo.festivalInfo.FestivalInformationVO">
		SELECT FI_NUM,
		<include refid="festivalInformationColumns"></include>
		FROM FESTIVAL_INFORMATION
		WHERE FI_NUM = #{fiNum}
	</select>
	<select id="selectFestivalInformationLists" resultType="today.whatdo.festival.vo.festivalInfo.FestivalInformationVO" parameterType="today.whatdo.festival.vo.festivalInfo.SearchParameterVO">
		SELECT FI_NUM,
		<include refid="festivalInformationColumns"></include>
		FROM FESTIVAL_INFORMATION
		<where>
			<if test='fesMonth!="" and fesMonth!=null'>
				AND LEFT(EVENTENDDATE,6) > CONCAT('2023',#{fesMonth})
				AND CONCAT('2023',#{fesMonth}) > LEFT(EVENTSTARTDATE,6)
			</if>
			<if test='fesLocal!="" and fesLocal!=null'>
				AND ADDR1 LIKE CONCAT(#{fesLocal},'%')
			</if>
		</where>
	</select>
	<update id="updateFestivalInformation">
		UPDATE FESTIVAL_INFORMATION
		SET
		ADDR1 = #{addr1}, ADDR2 = #{addr2}, AREACODE = #{areacode}, BOOKTOUR = #{booktour},
		CAT1 = #{cat1}, CAT2 = #{cat2}, CAT3 = #{cat3}, CONTENTID = #{contentid},
		CONTENTTYPEID = #{contenttypeid}, CREATEDTIME = #{createdtime}, EVENTSTARTDATE = #{eventstartdate}, EVENTENDDATE = #{eventenddate},
		FIRSTIMAGE = #{firstimage}, FIRSTIMAGE2 = #{firstimage2}, MAPX = #{mapx}, MAPY = #{mapy},
		MLEVEL = #{mlevel}, MODIFIEDTIME = #{modifiedtime}, READCOUNT = #{readcount}, SIGUNGUCODE = #{sigungucode},
		TEL = #{tel}, TITLE = #{title}
		WHERE FI_NUM = #{fiNum}
	</update>
</mapper>